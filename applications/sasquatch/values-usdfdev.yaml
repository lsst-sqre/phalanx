strimzi-kafka:
  kafka:
    config:
      log.retention.minutes: 10080
      offsets.retention.minutes: 10080
    listeners:
      tls:
        enabled: true
      plain:
        enabled: true
      external:
        enabled: true
    externalListener:
      tls:
        enabled: true
      bootstrap:
        annotations:
          metallb.io/address-pool: sdf-rubin-ingest
        allocateLoadBalancerNodePorts: false
      brokers:
        - broker: 0
          annotations:
            metallb.io/address-pool: sdf-rubin-ingest
        - broker: 1
          annotations:
            metallb.io/address-pool: sdf-rubin-ingest
        - broker: 2
          annotations:
            metallb.io/address-pool: sdf-rubin-ingest
  mirrormaker2:
    enabled: false
    source:
      bootstrapServer: sasquatch-base-kafka-bootstrap.lsst.codes:9094
      topicsPattern: "registry-schemas, lsst.sal.*, lsst.dm.*"
  users:
    replicator:
      enabled: true
    telegraf:
      enabled: true
  controller:
    enabled: true
  broker:
    enabled: true
    storage:
      size: 500Gi
  connect:
    enabled: true

schema-registry:
  enabled: true
  ingress:
    enabled: true

influxdb:
  startupProbe:
    enabled: true
    failureThreshold: 12
    periodSeconds: 300
  ingress:
    enabled: false
    hostname: usdf-rsp-dev.slac.stanford.edu
  persistence:
    enabled: true
    size: 15Ti
  config:
    coordinator:
      query-timeout: 300s
  resources:
    requests:
      memory: 96Gi
      cpu: 8
    limits:
      memory: 96Gi
      cpu: 8

customInfluxDBIngress:
  enabled: true
  hostname: usdf-rsp-dev.slac.stanford.edu
  annotations:
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "300"

telegraf:
  enabled: true
  influxdb:
    urls:
      - "https://usdf-rsp.slac.stanford.edu/influxdb-enterprise-data"
  kafkaConsumers:
    verify:
      enabled: true
      debug: true
      database: "lsst.verify"
      topicRegexps: |
        [ "lsst.verify" ]
      timestamp_field: "timestamp"
      tags: |
        [ "dataset_tag", "band", "instrument", "skymap", "detector", "physical_filter", "tract", "patch", "pipeline"]
    prompt:
      enabled: true
      debug: true
      database: "lsst.prompt"
      topicRegexps: |
        [ "lsst.prompt" ]
      timestamp_field: "timestamp"
      tags: |
        [ "dataset_tag", "band", "instrument", "skymap", "detector", "physical_filter", "tract", "patch", "group"]
    dm:
      enabled: true
      debug: true
      database: "lsst.dm"
      topicRegexps: |
        [ "lsst.dm" ]
      timestamp_field: "timestamp"
      tags: |
        [ "dataset_tag", "band", "instrument", "skymap", "detector", "physical_filter", "tract", "patch"]
  resources:
    limits:
      cpu: "1"
      memory: "512Mi"
    requests:
      cpu: "1"
      memory: "512Mi"

kafdrop:
  ingress:
    enabled: true

rest-proxy:
  enabled: true
  ingress:
    enabled: true
    anonymous: true
  kafka:
    topicPrefixes:
      - test
      - lsst.dm
      - lsst.debug
      - lsst.example
      - lsst.rubintv
      - lsst.camera
      - lsst.verify
      - lsst.lf
      - lsst.prompt
chronograf:
  ingress:
    enabled: true
    hostname: usdf-rsp-dev.slac.stanford.edu

  env:
    GENERIC_NAME: "OIDC"
    GENERIC_AUTH_URL: https://usdf-rsp-dev.slac.stanford.edu/auth/openid/login
    GENERIC_TOKEN_URL: https://usdf-rsp-dev.slac.stanford.edu/auth/openid/token
    USE_ID_TOKEN: 1
    JWKS_URL: https://usdf-rsp-dev.slac.stanford.edu/.well-known/jwks.json
    GENERIC_API_URL: https://usdf-rsp-dev.slac.stanford.edu/auth/userinfo
    GENERIC_SCOPES: openid
    GENERIC_API_KEY: sub
    PUBLIC_URL: https://usdf-rsp-dev.slac.stanford.edu/
    STATUS_FEED_URL: https://raw.githubusercontent.com/lsst-sqre/rsp_broadcast/main/jsonfeeds/usdfdev.json

app-metrics:
  enabled: true
  apps:
    - gafaelfawr
    - noteburst

backup:
  enabled: true
  persistence:
    size: 1Ti
    storageClass: wekafs--sdf-k8s01
  backupItems:
    - name: "chronograf"
      enabled: true
      retentionDays: 7
    - name: "kapacitor"
      enabled: true
      retentionDays: 7
    - name: "influxdb-oss-full"
      enabled: true
      retentionDays: 3

prompt-processing:
  enabled: true
  topics:
    - test.next-visit
    - test.next-visit-job

obsloctap:
  enabled: true

consdb:
  enabled: true

tap:
  enabled: true
