apiVersion: "grafana.integreatly.org/v1beta1"
kind: "GrafanaDatasource"
metadata:
  name: "vm"
  labels:
    {{- include "victoria-metrics.labels" . | nindent 4 }}
spec:
  allowCrossNamespaceImport: true
  datasource:
    access: "proxy"
    type: "victoriametrics-metrics-datasource"
    jsonData:
      timeInterval: "5s"
      tlsSkipVerify: true
      vmuiUrl: "{{ .Values.global.baseUrl }}/{{ .Values.vm.pathPrefix }}/vmui"
    name: "VictoriaMetrics"
    url: "http://vmsingle-victoria-metrics.victoria-metrics.svc:8429"
  instanceSelector:
    matchLabels:
      dashboards: "grafana"
  plugins:
    - name: "victoriametrics-metrics-datasource"
      version: "0.14.0"
---
apiVersion: "grafana.integreatly.org/v1beta1"
kind: "GrafanaDatasource"
metadata:
  name: "vmprometheus"
  labels:
    {{- include "victoria-metrics.labels" . | nindent 4 }}
spec:
  allowCrossNamespaceImport: true
  datasource:
    name: "VictoriaMetrics - Prometheus"
    type: prometheus
    access: proxy
    url: "http://vmsingle-victoria-metrics.victoria-metrics.svc:8429"
    jsonData:
      httpMethod: POST
      manageAlerts: true
      prometheusType: Prometheus
      prometheusVersion: 2.44.0
      cacheLevel: 'High'
      disableRecordingRules: false
      incrementalQueryOverlapWindow: 10m
  instanceSelector:
    matchLabels:
      dashboards: "grafana"
